# GOT and PLT for pwning

- Static binaries load all required functionality into the binary itself. Dynamic binaries locate the required functions at runtime.

- **Relocation**: strategy for resolving dynamically linked functions in the presence of ASLR and PIE. This is performed by the `linker` after the `loader` loads the binary. On a side note, RELRO asks the linker to populate the tables and make them readable just to prevent these attacks being discussed.

- Sections:

	- **.got**: Global offset table (linker fills in this table for external symbols)

	- **.plt**: Procedure linkage table. Stubs that look up addresses in the `.got.plt` section and jump to those addresses or ask the linker to populate `.got.plt`

	- **.got.plt**: Either contains the addresses of the procedures to jump to, or pointers to stubs in `PLT` section to look up addresses for external symbols.

	- **.plt.got**: Jumps to the first entry of `.got`


## Tracing PLT and GOT updates


```s
// Build with: gcc -no-pie -g -o plt plt.c

#include <stdio.h>
#include <stdlib.h>

int main(int argc, char** argv){
	puts("Hello world!");
	exit(0);
}
```

Through `si` one can see how the system calls trace out. For instance, through instruction stepping, when `puts()` comes, the next step is

```c
0x401030 <puts@plt>: jmp    QWORD PTR [rip+0x2fe2]        # 0x404018 <puts@got.plt>
```
This is in the PLT. A simple method stub that jumps to the desired section in `.got.plt`. Upon derefencing `0x404018`, we get

```c
0x404018 <puts@got.plt>:        0x00401036
```
which is in the `got.plt` section as expected. Another `si`:

```c
=> 0x401036 <puts@plt+6>:       push   0x0
   0x40103b <puts@plt+11>:      jmp    0x401020
```
Since this is the first time calling `puts`, the first lookup is triggered. Keep on doing this and the following comes up:

```c
0x7ffff7fe8610 <_dl_runtime_resolve_xsavec>: push   rbx
0x7ffff7fe8611 <_dl_runtime_resolve_xsavec+1>:       mov    rbx,rsp
```

After a while, we have an entry for `puts` in the `plt`. Find it through `disass puts@plt`

```c
0x0000000000401030 <+0>:     jmp    QWORD PTR [rip+0x2fe2]        # 0x404018 <puts@got.plt>
   0x0000000000401036 <+6>:     push   0x0
   0x000000000040103b <+11>:    jmp    0x401020
```

## Pwning

- `.got.plt` section is basically a giant array of function pointers
